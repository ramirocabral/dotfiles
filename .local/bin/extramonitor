#!/bin/bash

# Configuraci√≥n de pantallas
intern="eDP-1"
extern="HDMI-1"

# Funci√≥n de ayuda
usage() {
    echo "Uso: $(basename "$0") [duplicate|extra|off] [left|right|above|below]"
    exit 1
}

[[ "$#" -lt 1 ]] && usage

action="$1"
position="${2:-right}" 

case "$action" in 
    "duplicate")
        echo "üì∫ Duplicando pantallas..."
        # Reseteamos primero para evitar bugs visuales
        xrandr --output "$extern" --off 
        xrandr --output "$extern" --mode 1920x1080 --output "$intern" --auto --output "$extern" --same-as "$intern"
        ;;

    "extra")
        case "$position" in
            "left")  flag="--left-of" ;;
            "right") flag="--right-of" ;;
            "above") flag="--above" ;;
            "below") flag="--below" ;;
            *) echo "‚ùå Posici√≥n inv√°lida"; usage ;;
        esac

        echo "üñ•Ô∏è Extendiendo pantalla hacia: $position"
        # Primero apagamos el externo brevemente para limpiar la config anterior
        # Esto evita el "bug" de superposici√≥n al cambiar de posici√≥n
        xrandr --output "$extern" --off
        sleep 0.5
        xrandr --output "$extern" --pos 0x0 --rotate normal --output "$intern" --primary --pos 0x0 --rotate normal --output "$extern" "$flag" "$intern"
        ;;

    "off")
        echo "üîå Desconectando monitor externo..."
        # IMPORTANTE: Primero encendemos el interno, luego matamos el externo
        xrandr --output "$intern" --auto --primary
        xrandr --output "$extern" --off
        ;;

    *)
        usage
        ;;
esac
